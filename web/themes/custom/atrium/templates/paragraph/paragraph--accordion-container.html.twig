{#
/**
 * @file
 * Template for "Accordion Container" Paragraph.
 */
#}
{% extends 'paragraph.html.twig' %}
{% block paragraph %}

  {% if content.field_body|render %}
    {% include '@organisms/sections/text-section/text-section.twig' with {
      background_variant: 'has-background-color--dark',
      body: content.field_body|render ? content.field_body : null,
    } only %}
  {% endif %}

  {% if content.field_accordions|render %}
    {% set accordion_content = [] %}
    {% set accordions = paragraph.field_accordions %}

    {% for key, item in accordions.value %}
      {# â‡£ This check is important because Accordion fields are NOT required.
      Empty accordions are possible, and would return the wrong data. #}
      {% if accordions.get(key).entity.field_title_display.value %}
        {% set accordion = accordions.get(key).entity %}

        {# Store each accordion in an array for the Pattern component. #}
        {% set accordion_content = accordion_content|merge([{
          title: accordion.field_title_display|view,
          body: accordion.field_body|view,
          title_attributes: create_attribute(),
          content_attributes: create_attribute(),
        }]) %}
      {% endif %}
    {% endfor %}

    {% include '@molecules/interactive/accordion/accordion.twig' with {
      id: paragraph_id,
      full: true,
      accordion: accordion_content,
      attributes: create_attribute(),
    } only %}

  {% endif %}

  {{ content|without(
    'field_accordions',
    'field_body'
  ) }}
{% endblock %}
